var init_dump;!function(t){"use strict";function e(t){t.find(".dump-collapsed").single_double_click(function(){i(this,null,"fast",!1)},function(){i(this,null,"fast",!0)},200)}function i(e,n,a,s){var o=t(e),r=o.closest(".dump");0==o.hasClass("dump-collapsed")&&(o=o.find(".dump-collapsed:first"));var c=o.next(".dump-content");n=null==n?!t(c).is(":visible"):n,o.toggleClass("dump-expanded",n),n||t(c).hide(a),s&&t(c).find(".dump-collapsed").each(function(){i(this,n,"",!1)}),n&&(t(c).show(a,function(){t(this).find(".CodeMirror").each(function(){this.editor.refresh()})}),d(r,r.data("dump-settings")))}function n(e){t('<div class="dump-expand" />').click(function(){var n=t('<div id="dump-overlay" />').hide().appendTo("body");t(document).resize(function(){t(n).height(t(document).height())}).trigger("resize");var a=t("<div>").addClass("dump").width(e.width()).height(e.height());e.before(a);var d=t("<div>").addClass("dump-close").appendTo(e);t(d).add(n).click(function(){e.fadeOut("fast",function(){t(n).fadeOut("fast",function(){t(n).remove()}),t(d).remove(),t(a).replaceWith(e),e.removeClass("overlay").css("top","").show(),i(e,!1,"",!0)})}),e.addClass("overlay").css("top",t(window).scrollTop()+125).appendTo("body"),i(e,!0,"",!1),t(n).fadeTo("fast",.7),e.fadeTo("fast",1)}).appendTo(e)}function a(e){e.find(".dump-string").each(function(){t(this).html('<div class="dump-string-tools"><span class="dump-string-format-plain dump-selected">PLAIN</span> <span class="dump-string-format-html">HTML</span></div><div class="dump-string-text">'+t(this).html()+"</div>")}),e.find(".dump-string-format-plain,.dump-string-format-html").click(function(){if(!t(this).hasClass("dump-selected")){t(this).siblings().removeClass("dump-selected"),t(this).addClass("dump-selected");var e=t(this).closest(".dump-string").find(".dump-string-text");if(t(this).hasClass("dump-string-format-plain"))t(e).text(t(e).data("text"));else{var i=t(e).text();t(e).data("text",i).html(""),t('<iframe style="background:#fff" />').load(function(){t(this).contents().get(0).write(i)}).appendTo(e)}}})}function d(e,i){var n=e.find(".dump-code:visible").add(e.filter(".dump-code"));if(!(n.length<=0)){var a=function(){n.each(function(){var e,i=t(this),n=parseInt(i.data("from")||1),a={value:i.text(),mode:"php"==i.data("language")?"text/x-php":i.data("language"),theme:i.data("theme")||"graynight",lineNumbers:!0,matchBrackets:!0,readOnly:!i.data("editable"),firstLineNumber:n};if(i.data("editable")){e=i.get(0);var d=CodeMirror.fromTextArea(e,a)}else var d=CodeMirror(function(t){e=t,i.replaceWith(t)},a);i.data("highlight")&&d.setLineClass(i.data("highlight")-n,"highlighted"),e.editor=d})};if("function"!=typeof CodeMirror){if(t(document).on("codemirror_loaded",a),window.loading_codemirror)return;window.loading_codemirror=!0,t([i.static_url+"/CodeMirror/codemirror.css",i.static_url+"/CodeMirror/theme/graynight.css"]).each(function(){t("<link/>",{rel:"stylesheet",type:"text/css",href:this}).appendTo("head")}),t.ajax({dataType:"script",cache:!0,url:i.static_url+"/CodeMirror/codemirror.js",success:function(){t(document).trigger("codemirror_loaded")}})}else a()}}t.fn.single_double_click=function(e,i,n){return this.each(function(){var a=0,d=this,s=function(){var t=document.createElement("div");return t.innerHTML="<!--[if IE]><i></i><![endif]-->",1===t.getElementsByTagName("i").length};s()?(t(this).bind("dblclick",function(t){a=2,i.call(d,t)}),t(this).bind("click",function(t){setTimeout(function(){2!=a&&e.call(d,t),a=0},n||300)})):t(this).bind("click",function(t){a++,1==a&&setTimeout(function(){1==a?e.call(d,t):i.call(d,t),a=0},n||300)})})},init_dump=function(e,i){return t(function(){return t(e).each(function(){s(t(this),i)})})};var s=function(t,i){t.data("dump-settings")||(t.data("dump-settings",i),e(t,i),n(t,i),a(t,i),d(t,i))}}(jQuery);